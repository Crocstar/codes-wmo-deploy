#parse("header.vm")
#set($nav="admin")
#parse("navbar.vm")

    <div class="container">
    #if($subject.isAuthenticated())
        <h2>Create a temporary password (API Key)</h2>
          <div class="alert alert-warning" role="alert">Only use this if you authenticate via OAuth (e.g. Google login), if you login by password this will replace the password with a temporary one that will expire.</div>
          <div class="row">
            <form class="form-inline ajax-inline-form" action="$root/system/security/createpassword" method="post">
              <input type="submit" value="Create password" class="btn" />
              <label class="text">
                  <input type="text" name="minstolive" value="60" class="input-mini"/>
                  Minutes to live
              </label>
            </form>
            <div id="form-result"></div>
          </div>
    
   <script type="text/javascript">
    $(function() {

        // General ajax forms which reload the page when actioned
        $(".ajax-inline-form").ajaxForm({
          success:
              function(data, status, xhr){
                 $("#form-result").html(data);
              },

          error:
            function(xhr, status, error){
               $("#form-result").html("<div class='alert'> <button type='button' class='close' data-dismiss='alert'>&times;</button>Action failed: " + error + " - " + xhr.responseText + "</div>");
            }
        });

    });

   </script>

    #else
        <h3>Sorry you must be logged in to access this page</h3>
    #end

    ## container will be closed by footer

#parse("footer.vm")
